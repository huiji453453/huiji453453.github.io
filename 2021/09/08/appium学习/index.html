<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>appium学习 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="1.Appium环境搭建JDK Andriod SDK Python Appium-Python-Client  Appium-desktop  Node.js Appium Appium-doctor    1和2二选一 2.Appium-desktop介绍Appium-desktop主界面包含三个菜单Simple,Advanced、Presets Simplehost设置Appium serv">
<meta property="og:type" content="article">
<meta property="og:title" content="appium学习">
<meta property="og:url" content="http://example.com/2021/09/08/appium%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1.Appium环境搭建JDK Andriod SDK Python Appium-Python-Client  Appium-desktop  Node.js Appium Appium-doctor    1和2二选一 2.Appium-desktop介绍Appium-desktop主界面包含三个菜单Simple,Advanced、Presets Simplehost设置Appium serv">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pic.imgdb.cn/item/6138737244eaada739e63607.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/6138738444eaada739e65454.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/613873ac44eaada739e6a8a7.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/613873f944eaada739e7350e.jpg">
<meta property="og:image" content="https://pic.imgdb.cn/item/6138797644eaada739f0c2fd.jpg">
<meta property="article:published_time" content="2021-09-08T08:20:00.000Z">
<meta property="article:modified_time" content="2021-09-10T07:48:42.406Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/6138737244eaada739e63607.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-appium学习" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/08/appium%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time class="dt-published" datetime="2021-09-08T08:20:00.000Z" itemprop="datePublished">2021-09-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      appium学习
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="1-Appium环境搭建"><a href="#1-Appium环境搭建" class="headerlink" title="1.Appium环境搭建"></a>1.<strong>Appium环境搭建</strong></h1><p>JDK</p>
<p>Andriod SDK</p>
<p>Python</p>
<p>Appium-Python-Client</p>
<ol>
<li>Appium-desktop</li>
<li><ul>
<li>Node.js</li>
<li>Appium</li>
<li>Appium-doctor</li>
</ul>
</li>
</ol>
<p>1和2二选一</p>
<h1 id="2-Appium-desktop介绍"><a href="#2-Appium-desktop介绍" class="headerlink" title="2.Appium-desktop介绍"></a>2.<strong>Appium-desktop介绍</strong></h1><p>Appium-desktop主界面包含三个菜单Simple,Advanced、Presets</p>
<h3 id="Simple"><a href="#Simple" class="headerlink" title="Simple"></a><strong>Simple</strong></h3><h4 id="host"><a href="#host" class="headerlink" title="host"></a><strong>host</strong></h4><p>设置Appium server的ip地址，本地调试可以将ip地址修改为127.0.0.1</p>
<h4 id="port"><a href="#port" class="headerlink" title="port"></a><strong>port</strong></h4><p>设置端口号，默认是4723不用修改</p>
<h4 id="start-server"><a href="#start-server" class="headerlink" title="start server"></a><strong>start server</strong></h4><p>启动 Appium server</p>
<h1 id="3-Capacity配置简介"><a href="#3-Capacity配置简介" class="headerlink" title="3.Capacity配置简介"></a>3.<strong>Capacity配置简介</strong></h1><h3 id="1-什么是Capability"><a href="#1-什么是Capability" class="headerlink" title="1. 什么是Capability"></a>1. <strong>什么是Capability</strong></h3><p>desired capability的功能是配置Appium会话。他们告诉Appium服务器您想要自动化的平台和应用程序。</p>
<p>Desired Capabilities是一组设置的键值对的集合，其中键对应设置的名称，而值对应设置的值。（如：”platformName”: “Android”）Desired Capabilities主要用于通知Appium服务器建立需要的Session。</p>
<p><em><strong>*Session*</strong></em></p>
<p>Appium的客户端和服务端之间进行通信都必须在一个Session的上下文中进行。客户端在发起通信的时候首先会发送一个叫作“Desired Capabilities”的JSON对象给服务器。服务器收到该数据后，会创建一个session并将session的ID返回到客户端。之后客户端可以用该session的ID发送后续的命令。</p>
<h3 id="2-常用Capability配置"><a href="#2-常用Capability配置" class="headerlink" title="2. 常用Capability配置"></a>2. <strong>常用Capability配置</strong></h3><p>主要分成了三部分：公共部分、ios部分、android部分，如果你android想用ios的那是不可能的，so，老老实实去了解每个平台有哪些，他们的作用是什么。下面我们介绍一些公用常用的,红色标记的为常用的选项。</p>
<p><img src="https://pic.imgdb.cn/item/6138737244eaada739e63607.jpg"></p>
<h3 id="3-Android独有Capability"><a href="#3-Android独有Capability" class="headerlink" title="3. Android独有Capability"></a>3. <strong>Android独有Capability</strong></h3><p><img src="https://pic.imgdb.cn/item/6138738444eaada739e65454.jpg"></p>
<h3 id="4-ios独有Capability"><a href="#4-ios独有Capability" class="headerlink" title="4. ios独有Capability"></a>4. <strong>ios独有Capability</strong></h3><p><img src="https://pic.imgdb.cn/item/613873ac44eaada739e6a8a7.jpg"></p>
<h3 id="5-Capability启动App"><a href="#5-Capability启动App" class="headerlink" title="5. Capability启动App"></a>5. <strong>Capability启动App</strong></h3><p>Automatic Server 本地AppiumServer服务</p>
<p>Custom Server：例如，如果要针对运行在网络中另一台计算机上的Appium服务器启动Inspector会话，这很有用。</p>
<p>Sauce Labs：如果您无法访问机器上的iOS模拟器，则可以利用Sauce Labs帐户在云中启动Appium会话。</p>
<p>TestObject：您还可以利用一些云测平台的真实设备云来进行真机测试。</p>
<p>headspin:使用远程设备来创建会话。</p>
<h3 id="6-desired-capability参数启动app"><a href="#6-desired-capability参数启动app" class="headerlink" title="6. desired capability参数启动app"></a>6. <strong>desired capability参数</strong>启动app</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"> &quot;platformName&quot;: &quot;Android&quot;,</span><br><span class="line"></span><br><span class="line"> &quot;platformVersion&quot;: &quot;7.1.2&quot;,</span><br><span class="line"></span><br><span class="line"> &quot;deviceName&quot;: &quot;127.0.0.1:62025&quot;,</span><br><span class="line"></span><br><span class="line"> &quot;appPackage&quot;: &quot;com.tal.kaoyan&quot;,</span><br><span class="line"></span><br><span class="line"> &quot;appActivity&quot;: &quot;com.tal.kaoyan.ui.activity.SplashActivity&quot;,</span><br><span class="line"></span><br><span class="line"> &quot;noReset&quot;: true</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">### </span><br></pre></td></tr></table></figure>

<h3 id="7-Inspector元素获取"><a href="#7-Inspector元素获取" class="headerlink" title="7. Inspector元素获取"></a>7. <strong>Inspector元素获取</strong></h3><p>启动成功之后就可以使用 Inspector来进行元素空间获取了。 注意：默认的元素定位有一些不准，需要切换到第二个坐标点定位选项后再切换回来才能准确定</p>
<h1 id="4-Appium元素定位相关操作"><a href="#4-Appium元素定位相关操作" class="headerlink" title="4.Appium元素定位相关操作"></a>4.<strong>Appium元素定位相关操作</strong></h1><p><img src="https://pic.imgdb.cn/item/613873f944eaada739e7350e.jpg"></p>
<h2 id="5-使用python-appium脚本启动程序"><a href="#5-使用python-appium脚本启动程序" class="headerlink" title="5.使用python+appium脚本启动程序"></a>5.<strong>使用python+appium脚本启动程序</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> appium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">desired_caps=&#123;&#125;</span><br><span class="line">desired_caps[<span class="string">&#x27;platformName&#x27;</span>]=<span class="string">&#x27;Android&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#模拟器设备</span></span><br><span class="line">desired_caps[<span class="string">&#x27;platformVersion&#x27;</span>]=<span class="string">&#x27;7.1.2&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;deviceName&#x27;</span>]=<span class="string">&#x27;127.0.0.1:62025&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;app&#x27;</span>]=<span class="string">r&#x27;D:\kaoyan3.1.0.apk&#x27;</span></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;appPackage&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appActivity&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan.ui.activity.SplashActivity&#x27;</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Remote(<span class="string">&#x27;http://localhost:4723/wd/hub&#x27;</span>, desired_caps)</span><br></pre></td></tr></table></figure>

<h1 id="5-元素定位"><a href="#5-元素定位" class="headerlink" title="5.元素定位"></a>5.<strong>元素定位</strong></h1><p>与Web自动化测试一样，app自动化测试过程中最重要一个环节就是元素定位，只有准确定位到了元素才能进行相关元素的操作，如输入、点击、拖拽、滑动等。</p>
<p>appium提供了许多元素定位的方法，如id定位、name定位、class定位、层级定位等等.</p>
<h2 id="一、元素定位方式"><a href="#一、元素定位方式" class="headerlink" title="一、元素定位方式"></a>一、<strong><strong>元素定位方式</strong></strong></h2><ol>
<li><p>id</p>
</li>
<li><p>name</p>
</li>
<li><p>class</p>
</li>
<li><p>List定位</p>
</li>
<li><p>相对定位</p>
</li>
<li><p>Xpath定位</p>
</li>
<li><p>H5页面元素定位</p>
</li>
<li><p>Uiautomator定位</p>
</li>
</ol>
<h2 id="二、id定位"><a href="#二、id定位" class="headerlink" title="二、id定位"></a>二、<strong><strong>id定位</strong></strong></h2><p>Appium中可以使用 <em><strong>find_element_by_id()</strong></em> 方法来进行id定位。</p>
<h3 id="1-测试场景1"><a href="#1-测试场景1" class="headerlink" title="1) 测试场景1"></a><strong>1) <em>测试场景1</em></strong></h3><ol>
<li><p>安装考研帮kaoyan3.1.0.apk</p>
</li>
<li><p>点击升级页面取消按钮</p>
</li>
<li><p>点击引导页面的跳过按钮</p>
</li>
</ol>
<h3 id="2-脚本实现"><a href="#2-脚本实现" class="headerlink" title="2) 脚本实现"></a><em>2) <strong>脚本实现</strong></em></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span>  appium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">desired_caps=&#123;&#125;</span><br><span class="line">desired_caps[<span class="string">&#x27;platformName&#x27;</span>]=<span class="string">&#x27;Android&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;deviceName&#x27;</span>]=<span class="string">&#x27;127.0.0.1:62025&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;platforVersion&#x27;</span>]=<span class="string">&#x27;5.1.1&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;app&#x27;</span>]=<span class="string">r&#x27;D:\kaoyan3.1.0.apk&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appPackage&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appActivity&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan.ui.activity.SplashActivity&#x27;</span></span><br><span class="line"></span><br><span class="line">driver=webdriver.Remote(<span class="string">&#x27;http://localhost:4723/wd/hub&#x27;</span>,desired_caps)</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;android:id/button2&#x27;</span>).click()</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/tv_skip&#x27;</span>).click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="三、思考"><a href="#三、思考" class="headerlink" title="三、思考"></a><em>三、思考</em></h2><p>· 如果安装的版本最新的包，或者升级到了最新的版本，则启动后没有升级弹窗元素该如何处理？</p>
<p>· 跳过引导页面首次启动和非首次启动场景该如何处理？</p>
<h3 id="异常捕捉"><a href="#异常捕捉" class="headerlink" title="异常捕捉"></a><em><strong>异常捕捉</strong></em></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span>  appium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</span><br><span class="line"></span><br><span class="line">desired_caps=&#123;&#125;</span><br><span class="line">desired_caps[<span class="string">&#x27;platformName&#x27;</span>]=<span class="string">&#x27;Android&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;deviceName&#x27;</span>]=<span class="string">&#x27;127.0.0.1:62025&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;platforVersion&#x27;</span>]=<span class="string">&#x27;7.1.2&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;app&#x27;</span>]=<span class="string">r&#x27;d:\kaoyan3.1.0.apk&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appPackage&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appActivity&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan.ui.activity.SplashActivity&#x27;</span></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;noReset&#x27;</span>]=<span class="string">&#x27;True&#x27;</span></span><br><span class="line"></span><br><span class="line">driver=webdriver.Remote(<span class="string">&#x27;http://localhost:4723/wd/hub&#x27;</span>,desired_caps)</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_cancelBtn</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;check_cancelBtn&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cancelBtn = driver.find_element_by_id(<span class="string">&#x27;android:id/button2&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;no CancelBtn&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cancelBtn.click()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_skipBtn</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;check_skipBtn&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        skipBtn = driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/tv_skip&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;check_skipBtn&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        skipBtn.click()</span><br><span class="line"></span><br><span class="line"><span class="comment">#check_updateBtn()</span></span><br><span class="line"></span><br><span class="line">check_skipBtn()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="四、id定位综合实践——自动登录"><a href="#四、id定位综合实践——自动登录" class="headerlink" title="四、id定位综合实践——自动登录"></a><strong>四、</strong>id定位综合实践——自动登录</h2><h3 id="测试场景"><a href="#测试场景" class="headerlink" title="测试场景"></a><em><strong>测试场景</strong></em></h3><ol>
<li><p>启动App，进入到登录界面</p>
</li>
<li><p>在登录页面输入用户名“liubo10010”，密码‘liubo10010’ 然后点击登录。</p>
</li>
</ol>
<h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a><em><strong>需求分析</strong></em></h3><ol>
<li><p>可以把启动后检测升级弹窗和引导页面的模块抽离作为独立的模块被其他模块调用，提高代码复用率。</p>
</li>
<li><p>获取用户名密码输入框和登录按钮的元素id属性,另外要考虑启动时App之前是否登录过账号，已经登录过和未登录场景流程不一样。</p>
</li>
<li><p>注意：send_keys()传入中文时需要在capability中配置如下内容：</p>
<p>desired_caps[‘unicodeKeyboard’]=”True”</p>
<p>desired_caps[‘resetKeyboard’]=”True”</p>
<p>设置之后会有Appium的输入法守护来执行输入操作</p>
</li>
</ol>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a><em><strong>代码实现</strong></em></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span>  appium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</span><br><span class="line"></span><br><span class="line">desired_caps=&#123;&#125;</span><br><span class="line">desired_caps[<span class="string">&#x27;platformName&#x27;</span>]=<span class="string">&#x27;Android&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;deviceName&#x27;</span>]=<span class="string">&#x27;127.0.0.1:62025&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;platforVersion&#x27;</span>]=<span class="string">&#x27;7.1.2&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;app&#x27;</span>]=<span class="string">r&#x27;d:\kaoyan3.1.0.apk&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appPackage&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan&#x27;</span></span><br><span class="line">desired_caps[<span class="string">&#x27;appActivity&#x27;</span>]=<span class="string">&#x27;com.tal.kaoyan.ui.activity.SplashActivity&#x27;</span></span><br><span class="line"></span><br><span class="line">desired_caps[<span class="string">&#x27;noReset&#x27;</span>]=<span class="string">&#x27;True&#x27;</span></span><br><span class="line"></span><br><span class="line">driver=webdriver.Remote(<span class="string">&#x27;http://localhost:4723/wd/hub&#x27;</span>,desired_caps)</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_cancelBtn</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;check_cancelBtn&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cancelBtn = driver.find_element_by_id(<span class="string">&#x27;android:id/button2&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;no CancelBtn&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cancelBtn.click()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_skipBtn</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;check_skipBtn&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        skipBtn = driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/tv_skip&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;check_skipBtn&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        skipBtn.click()</span><br><span class="line"></span><br><span class="line"><span class="comment">#check_updateBtn()</span></span><br><span class="line"></span><br><span class="line">check_skipBtn()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_email_edittext&#x27;</span>).clear()</span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_email_edittext&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_password_edittext&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_login_btn&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/mainactivity_button_mysefl&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">    login()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/mainactivity_button_mysefl&#x27;</span>).click()</span><br><span class="line">    driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_usercenter_username&#x27;</span>).click()</span><br><span class="line">    login()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="五、name定位"><a href="#五、name定位" class="headerlink" title="五、name定位"></a><em>五、name定位</em></h2><p>根据name进行定位，对于android来说，就是text属性</p>
<p>但是由于text稳定性不是很好，所以appium 1.5开始废弃了该方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> *</span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;请输入用户名&#x27;</span>).send_keys(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;登录&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<p><em><strong>运行提示： Locator Strategy ‘name’ is not supported for this session</strong></em></p>
<h2 id="六、classname定位"><a href="#六、classname定位" class="headerlink" title="六、classname定位"></a>六、<strong><strong>classname定位</strong></strong></h2><p>classname定位是根据元素类型来进行定位，但是实际情况中很多元素的classname都是相同的，如上例中登录页面中的用户名和密码都是clasName属性值都是：<em><strong>“android.widget.EditText”</strong></em> 因此只能定位第一个元素也就是用户名，而密码输入框就需要使用其他方式来定位，这样其实很鸡肋.一般情况下如果有id就不必使用classname定位。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> *</span><br><span class="line">driver.find_element_by_class_name(<span class="string">&#x27;android.widget.EditText&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line">driver.find_element_by_class_name(<span class="string">&#x27;android.widget.EditText&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line">driver.find_element_by_class_name(<span class="string">&#x27;android.widget.Button&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<h2 id="七、相对定位"><a href="#七、相对定位" class="headerlink" title="七、相对定位"></a><em>七、相对定位</em></h2><p>相对定位是先找到该元素的有对应属性的父元素节点，然后基于父元素进行元素定位。</p>
<h5 id="测试案例"><a href="#测试案例" class="headerlink" title="测试案例"></a><em><strong>测试案例</strong></em></h5><p>不使用id元素定位方式，在新用户注册界面点击添加头像按钮。</p>
<h5 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a><em><strong>代码实现</strong></em></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_register_text&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">root_element=driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_parentlayout&#x27;</span>)</span><br><span class="line">root_element.find_element_by_class_name(<span class="string">&#x27;android.widget.ImageView&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<h2 id="八、xpath定位"><a href="#八、xpath定位" class="headerlink" title="八、xpath定位"></a>八、<strong><strong>xpath定位</strong></strong></h2><p>xpath定位是一种路径定位方式，主要是依赖于元素绝对路径或者相关属性来定位，但是绝对路径xpath执行效率比较低（特别是元素路径比较深的时候），一般使用比较少。通常使用xpath相对路径和属性定位。</p>
<p>xpath路径表达式</p>
<table>
<thead>
<tr>
<th><em><strong>表达式</strong></em></th>
<th><em><strong>描述</strong></em></th>
</tr>
</thead>
<tbody><tr>
<td>/</td>
<td>从根节点选取。</td>
</tr>
<tr>
<td>//</td>
<td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</td>
</tr>
<tr>
<td>nodename</td>
<td>选取此节点的所有子节点。</td>
</tr>
<tr>
<td>.</td>
<td>选取当前节点。</td>
</tr>
<tr>
<td>..</td>
<td>选取当前节点的父节点。</td>
</tr>
<tr>
<td>@</td>
<td>选取属性。</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th><em><strong>通配符</strong></em></th>
<th><em><strong>描述</strong></em></th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>匹配任何元素节点。</td>
</tr>
<tr>
<td>@*</td>
<td>匹配任何属性节点。</td>
</tr>
<tr>
<td>node()</td>
<td>匹配任何类型的节点。</td>
</tr>
</tbody></table>
<h5 id="案例"><a href="#案例" class="headerlink" title="案例"></a><em><strong>案例</strong></em></h5><p>使用xpath定位元素来进行登录操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;//android.widget.EditText[@text=&quot;请输入用户名&quot;]&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;//*[@class=&quot;android.widget.EditText&quot; and @index=&quot;3&quot;]&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;//android.widget.Button&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<h2 id="九、List定位"><a href="#九、List定位" class="headerlink" title="九、List定位"></a>九、<strong><strong>List定位</strong></strong></h2><p>前面我们提到相同的classname属性值元素无法区分定位，现在将使用List定位来解决这个问题。List定位首先是使用<strong>find_elements_by_XX</strong>获取一组相同的class属性的元素，然后使用数组下标来区分标记不同元素进行相关操作。</p>
<h5 id="测试案例1"><a href="#测试案例1" class="headerlink" title="测试案例1"></a><em><strong>测试案例1</strong></em></h5><p>在新用户注册界面点击添加头像按钮后，选择指定的图片保存作为头像。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_register_text&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_userheader&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">images=driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/item_image&#x27;</span>)</span><br><span class="line"></span><br><span class="line">images[<span class="number">2</span>].click()</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/save&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<h3 id="list定位综合案例——用户注册"><a href="#list定位综合案例——用户注册" class="headerlink" title="list定位综合案例——用户注册"></a><em><strong>list定位综合案例——用户注册</strong></em></h3><h5 id="测试场景-1"><a href="#测试场景-1" class="headerlink" title="测试场景"></a><strong><strong>测试场景</strong></strong></h5><ol>
<li><p>进入注册界面设置头像</p>
</li>
<li><p>输入注册信息：用户名、密码、邮箱</p>
</li>
<li><p>完善院校和专业信息 （院校：上海-同济大学 专业：经济学类-统计学-经济统计学）</p>
</li>
<li><p>完成注册</p>
</li>
</ol>
<h5 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a><em><strong>代码实现</strong></em></h5><p>注意：运行前记得将noRest设置为：desired_caps[‘noReset’]=’False’ 以免之前的注册残留信息干扰。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment">#进入注册界面选择并设置头像</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_register_text&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_userheader&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">images=driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/item_image&#x27;</span>)</span><br><span class="line"></span><br><span class="line">images[<span class="number">2</span>].click()</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/save&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment">#注册信息填写</span></span><br><span class="line">username=<span class="string">&#x27;Test&#x27;</span>+<span class="string">&#x27;FLY&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1000</span>,<span class="number">9000</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;username: %s&#x27;</span> %username)</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_username_edittext&#x27;</span>).send_keys(username)</span><br><span class="line"></span><br><span class="line">password=<span class="string">&#x27;appium&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1000</span>,<span class="number">9000</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;password: %s&#x27;</span> %password)</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_password_edittext&#x27;</span>).send_keys(password)</span><br><span class="line"></span><br><span class="line">email=<span class="string">&#x27;pwd&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1000</span>,<span class="number">9000</span>))+<span class="string">&#x27;@163.com&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;email: %s&#x27;</span> %email)</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_email_edittext&#x27;</span>).send_keys(email)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_register_register_btn&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#院校选择</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/perfectinfomation_edit_school_name&#x27;</span>).click()</span><br><span class="line"><span class="comment">#选择省份</span></span><br><span class="line">driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/more_forum_title&#x27;</span>)[<span class="number">1</span>].click()</span><br><span class="line"><span class="comment">#选择具体院校--同济大学</span></span><br><span class="line">driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/university_search_item_name&#x27;</span>)[<span class="number">1</span>].click()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#专业选择</span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_perfectinfomation_major&#x27;</span>).click()</span><br><span class="line"><span class="comment">#选择经济学类-统计学-经济统计学</span></span><br><span class="line">driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/major_subject_title&#x27;</span>)[<span class="number">1</span>].click()</span><br><span class="line">driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/major_group_title&#x27;</span>)[<span class="number">2</span>].click()</span><br><span class="line">driver.find_elements_by_id(<span class="string">&#x27;com.tal.kaoyan:id/major_search_item_name&#x27;</span>)[<span class="number">1</span>].click()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#点击“进入考研帮”按钮</span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_perfectinfomation_goBtn&#x27;</span>).click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="十、UIAutomator定位简介"><a href="#十、UIAutomator定位简介" class="headerlink" title="十、UIAutomator定位简介"></a>十、<strong><strong>UIAutomator定位简介</strong></strong></h2><p>UIAutomator元素定位是 Android 系统原生支持的定位方式，虽然与 xpath 类似，但比它更加好用，且支持元素全部属性定位.定位原理是通过android 自带的android uiautomator的类库去查找元素。使用法 <em><strong>find_element_by_android_uiautomator()</strong></em> 可以运用UiAutomator元素定位。</p>
<h3 id="定位方法"><a href="#定位方法" class="headerlink" title="定位方法"></a><em><strong>定位方法</strong></em></h3><p>· id定位</p>
<p>· text定位</p>
<p>· class name定位</p>
<h3 id="id定位"><a href="#id定位" class="headerlink" title="id定位"></a><em><strong>id定位</strong></em></h3><p>id定位是根据元素的resource-id属性来进行定位，使用 UiSelector().resourceId()方法即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line"></span><br><span class="line">driver.find_element_by_android_uiautomator(<span class="string">&#x27;new UiSelector().resourceId(&quot;com.tal.kaoyan:id/login_email_edittext&quot;)&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_android_uiautomator\</span><br><span class="line">    (<span class="string">&#x27;new UiSelector().resourceId(&quot;com.tal.kaoyan:id/login_password_edittext&quot;)&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_android_uiautomator\</span><br><span class="line">    (<span class="string">&#x27;new UiSelector().resourceId(&quot;com.tal.kaoyan:id/login_login_btn&quot;)&#x27;</span>).click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a><em><strong>思考</strong></em></h3><p>在自动化过程中，元素出现受网络环境，设备性能等多种因素影响。因此元素加载的时间可能不一致，从而会导致元素无法定位超时报错，但是实际上元素是正常加载了的，只是出现时间晚一点而已。那么如何解决这个问题呢？</p>
<h2 id="6-元素等待作用"><a href="#6-元素等待作用" class="headerlink" title="6.元素等待作用"></a>6.<strong>元素等待作用</strong></h2><p>设置元素等待可以更加灵活的制定等待定位元素的时间，从而增强脚本的健壮性，提高执行效率。</p>
<p>元素等待类型分为强制等待、隐式等待、显示等待</p>
<h4 id="强制等待"><a href="#强制等待" class="headerlink" title="强制等待"></a><strong>强制等待</strong></h4><p>设置固定的等待时间，使用sleep()方法即可实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="comment">#强制等待5秒</span></span><br><span class="line">sleep(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h4 id="隐式等待"><a href="#隐式等待" class="headerlink" title="隐式等待"></a><strong>隐式等待</strong></h4><p>隐式等待是针对全部元素设置的等待时间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.implicitly_wait(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>

<h4 id="显式等待"><a href="#显式等待" class="headerlink" title="显式等待"></a><strong>显式等待</strong></h4><p>显式等待是针对某个元素来设置的等待时间。</p>
<p>方法WebDriverWait格式参数如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"></span><br><span class="line">WebDriverWait(driver, timeout, poll_frequency=<span class="number">0.5</span>, ignored_exceptions=<span class="literal">None</span>)</span><br><span class="line">driver : WebDriver</span><br><span class="line">timeout : 最长超时时间，默认以秒为单位</span><br><span class="line">poll_frequency : 休眠时间的间隔时间，默认为<span class="number">0.5</span>秒</span><br><span class="line">ignored_exceptions : 超时后的异常信息，默认情况下抛NoSuchElementException异常。</span><br></pre></td></tr></table></figure>

<p>WebDriverWait()一般和until()或until_not()方法配合使用，另外，lambda提供了一个运行时动态创建函数的方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line">WebDriverWait(driver,<span class="number">10</span>).until(<span class="keyword">lambda</span> x:x.find_element_by_id(<span class="string">&quot;elementID&quot;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="7-截图方法"><a href="#7-截图方法" class="headerlink" title="7.截图方法"></a>7.<strong>截图方法</strong></h2><h4 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a><strong>方法1</strong></h4><p>save_screenshot() 该方法直接保存当前屏幕截图到当前脚本所在文件位置。</p>
<p><code>driver.save_screenshot(&#39;login.png&#39;)</code></p>
<h4 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a><strong>方法2</strong></h4><p>get_screenshot_as_file(self, filename)</p>
<p>将截图保留到指定文件路径</p>
<p><code>driver.get_screenshot_as_file(&#39;./images/login.png&#39;)</code></p>
<h4 id="测试场景-2"><a href="#测试场景-2" class="headerlink" title="测试场景"></a><strong>测试场景</strong></h4><p>在考研帮App登录页面输入用户名和密码之后截图，分别保存到当前文件和指定的文件路径。</p>
<h4 id="代码实现-3"><a href="#代码实现-3" class="headerlink" title="代码实现"></a><strong>代码实现</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_email_edittext&#x27;</span>).clear()</span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_email_edittext&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_password_edittext&#x27;</span>).send_keys(<span class="string">&#x27;liubo10010&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.save_screenshot(<span class="string">&#x27;login.png&#x27;</span>)</span><br><span class="line">driver.get_screenshot_as_file(<span class="string">&#x27;./images/login.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/login_login_btn&#x27;</span>).click()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="8-滑动效果"><a href="#8-滑动效果" class="headerlink" title="8.滑动效果"></a><em>8.<strong>滑动效果</strong></em></h2><p>在app应用日常使用过程中，会经常用到在屏幕滑动操作。如刷朋友圈上下滑操作、浏览图片左右滑动操作等。在自动化脚本该如何实现这些操作呢？</p>
<p>在Appium中模拟用户滑动操作需要使用swipe方法，该方法定义如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swipe</span>(<span class="params">self, start_x, start_y, end_x, end_y, duration=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Swipe from one point to another point, for an optional duration.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :Args:</span></span><br><span class="line"><span class="string">     - start_x - x-coordinate at which to start</span></span><br><span class="line"><span class="string">     - start_y - y-coordinate at which to start</span></span><br><span class="line"><span class="string">     - end_x - x-coordinate at which to stop</span></span><br><span class="line"><span class="string">     - end_y - y-coordinate at which to stop</span></span><br><span class="line"><span class="string">     - duration - (optional) time to take the swipe, in ms.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :Usage:</span></span><br><span class="line"><span class="string">        driver.swipe(100, 100, 100, 400)</span></span><br></pre></td></tr></table></figure>

<p>滑动解析</p>
<p>swipe()方法的参数说明：<br>start_x：起始横坐标<br>start_y：起始纵坐标<br>end_x：结束时横坐标<br>end_y：结束时纵坐标<br>duration：滑动持续时间，单位毫秒，默认None（一般设置500-1000毫秒比较合适）</p>
<p>滑动主要分为：</p>
<ol>
<li><p>水平滑动</p>
</li>
<li><p>垂直滑动</p>
</li>
<li><p>任意方向滑动</p>
</li>
</ol>
<p>滑动轨迹图如下：</p>
<p><img src="https://pic.imgdb.cn/item/6138797644eaada739f0c2fd.jpg"></p>
<p>实践应用</p>
<h4 id="测试场景-3"><a href="#测试场景-3" class="headerlink" title="测试场景"></a><strong>测试场景</strong></h4><p>· 安装启动考研帮，手动向水平左滑动首页引导页面。</p>
<p>· 点击“立即体验”进入登录页面。</p>
<h4 id="代码实现-4"><a href="#代码实现-4" class="headerlink" title="代码实现"></a><strong>代码实现</strong></h4><p>注意：运行前记得将capablity里面的check_skipBtn()先注释掉，否则直接跳过了无法滑动引导页面。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> Capability <span class="keyword">import</span> driver</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取屏幕尺寸</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_size</span>():</span></span><br><span class="line">    x=driver.get_window_size()[<span class="string">&#x27;width&#x27;</span>]</span><br><span class="line">    y=driver.get_window_size()[<span class="string">&#x27;height&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> x,y</span><br><span class="line"></span><br><span class="line"><span class="comment">#显示屏幕尺寸（width,height）</span></span><br><span class="line">l=get_size()</span><br><span class="line"><span class="built_in">print</span>(l)</span><br><span class="line"></span><br><span class="line"><span class="comment">#向左滑动</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">swipeLeft</span>():</span></span><br><span class="line">    l=get_size()</span><br><span class="line">    x1=<span class="built_in">int</span>(l[<span class="number">0</span>]*<span class="number">0.9</span>)</span><br><span class="line">    y1=<span class="built_in">int</span>(l[<span class="number">1</span>]*<span class="number">0.5</span>)</span><br><span class="line">    x2=<span class="built_in">int</span>(l[<span class="number">0</span>]*<span class="number">0.1</span>)</span><br><span class="line">    driver.swipe(x1,y1,x2,y1,<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#向左滑动2次</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    swipeLeft()</span><br><span class="line">    sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&#x27;com.tal.kaoyan:id/activity_splash_guidfinish&#x27;</span>).click()</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/08/appium%E5%AD%A6%E4%B9%A0/" data-id="cktbc64do0000ootygm9t9jho" data-title="appium学习" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/09/10/python%E5%8F%91%E9%80%81%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A%E7%9A%84%E6%A8%A1%E6%9D%BF/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          python发送测试报告的模板
        
      </div>
    </a>
  
  
    <a href="/2021/09/07/python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">python单元测试</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/09/14/django%E8%BF%9E%E6%8E%A5mysql/">django连接mysql</a>
          </li>
        
          <li>
            <a href="/2021/09/13/pip%E5%AE%89%E8%A3%85%E5%BA%93%E6%97%B6%E4%BD%BF%E7%94%A8%E8%B1%86%E7%93%A3%E9%95%9C%E5%83%8F/">pip安装库时使用豆瓣镜像</a>
          </li>
        
          <li>
            <a href="/2021/09/10/python%E5%8F%91%E9%80%81%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A%E7%9A%84%E6%A8%A1%E6%9D%BF/">python发送测试报告的模板</a>
          </li>
        
          <li>
            <a href="/2021/09/08/appium%E5%AD%A6%E4%B9%A0/">appium学习</a>
          </li>
        
          <li>
            <a href="/2021/09/07/python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">python单元测试</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>