<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>web自动化测试 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="1.selenium IDE1.Selenium IDE 的介绍​    Selenium IDE(集成开发环境)是 Selenium Suite 下的开源 Web 自动化测试  工具。 与 Selenium WebDriver 和 RC 不同，它不需要任何编程逻辑来编写其测  试脚本，而只需记录与浏览器的交互以创建测试用例。 之后，可以使用播放选  项重新运行测试用例。  ​    也许，在 S">
<meta property="og:type" content="article">
<meta property="og:title" content="web自动化测试">
<meta property="og:url" content="http://example.com/2021/09/07/web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="1.selenium IDE1.Selenium IDE 的介绍​    Selenium IDE(集成开发环境)是 Selenium Suite 下的开源 Web 自动化测试  工具。 与 Selenium WebDriver 和 RC 不同，它不需要任何编程逻辑来编写其测  试脚本，而只需记录与浏览器的交互以创建测试用例。 之后，可以使用播放选  项重新运行测试用例。  ​    也许，在 S">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-09-07T08:00:49.000Z">
<meta property="article:modified_time" content="2021-09-07T09:25:11.124Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-web自动化测试" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/07/web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" class="article-date">
  <time class="dt-published" datetime="2021-09-07T08:00:49.000Z" itemprop="datePublished">2021-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      web自动化测试
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="1-selenium-IDE"><a href="#1-selenium-IDE" class="headerlink" title="1.selenium IDE"></a><strong>1.selenium IDE</strong></h1><h2 id="1-Selenium-IDE-的介绍"><a href="#1-Selenium-IDE-的介绍" class="headerlink" title="1.Selenium IDE 的介绍"></a><strong>1.Selenium IDE</strong> <strong>的介绍</strong></h2><p>​    Selenium IDE(集成开发环境)是 Selenium Suite 下的开源 Web 自动化测试 </p>
<p>工具。 与 Selenium WebDriver 和 RC 不同，它不需要任何编程逻辑来编写其测 </p>
<p>试脚本，而只需记录与浏览器的交互以创建测试用例。 之后，可以使用播放选 </p>
<p>项重新运行测试用例。 </p>
<p>​    也许，在 Selenium IDE 上创建测试用例不需要任何编程语言，但是当使用 </p>
<p>像 runScript 这样选择命令时，JavaScript 一些知识对更清楚地理解这些概念 </p>
<p>是有益的。</p>
<h2 id="2-Selenium-IDE-的安装"><a href="#2-Selenium-IDE-的安装" class="headerlink" title="2.Selenium IDE 的安装"></a><strong>2.Selenium IDE</strong> <strong>的安装</strong></h2><p>推荐 Selenium IDE 用 Firefox(火狐浏览器)插件来安装，假设您已在系统中安 </p>
<p>装了 Mozilla Firefox 浏览器。如果尚未安装，那么可以通过以下链接提供的官方 </p>
<p>网站下载最新版本的 Firefox。 </p>
<p>Firefox 浏览器下载 =&gt; <a target="_blank" rel="noopener" href="https://www.mozilla.org/en-US/firefox/new/">https://www.mozilla.org/en-US/firefox/new/</a></p>
<p><strong>Selenium IDE 下载并安装</strong> </p>
<p>启动 Mozilla Firefox 浏览器。 </p>
<p>打开 URL =&gt; <a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-us/firefox/addon/selenium-ide/">https://addons.mozilla.org/en-us/firefox/addon/selenium-ide/</a> ， 它会将重定 </p>
<p>向到 Firefox 的官方附加页面。 </p>
<p>点击 <strong>Add to Firefox</strong> 按钮。 </p>
<p>将出现一个弹出对话框，要求将 Selenium IDE 添加为 Firefox 浏览器的扩展名。 </p>
<p>点击 <strong>Add</strong> 按钮。 </p>
<p>重新启动 Firefox 浏览器。 </p>
<p>转到 Firefox 浏览器的右上角，查找 Selenium IDE 图标。</p>
<p>单击该图标以启动 Selenium IDE。</p>
<h2 id="3-Selenium-IDE-功能特性【重点】"><a href="#3-Selenium-IDE-功能特性【重点】" class="headerlink" title="3.Selenium IDE 功能特性【重点】"></a><strong>3.Selenium IDE</strong> <strong>功能特性【重点】</strong></h2><p>Selenium IDE 分为不同的组件，每个组件都有自己的特性和功能。这里对 Selenium </p>
<p>IDE 的七个不同组件进行了分类，其中包括: </p>
<ul>
<li>菜单栏 </li>
<li>工具栏 </li>
<li>地址栏 </li>
<li>测试案例窗格 </li>
<li>测试脚本编辑器框</li>
<li>开始/停止录制按钮 </li>
<li>日志，引用窗格</li>
</ul>
<p><strong>1. 菜单栏</strong> </p>
<p>菜单栏位于 Selenium IDE 界面的最顶部。 最常用的菜单栏模块包括: </p>
<p>​    <strong>项目名</strong> - </p>
<p>​    它用于重命名整个项目。 </p>
<p>​    <strong>打开项目</strong> </p>
<p>​    它用于从个人驱动器加载任何现有项目。 </p>
<p>​    <strong>保存项目</strong> </p>
<p>​    它用于保存当前正在处理的整个项目。 </p>
<p><strong>2. 工具栏</strong> </p>
<p>​    工具栏包含用于控制测试用例执行的模块。 此外，它还为提供了调试测试用例 </p>
<p>​    的步骤功能。 </p>
<p>​    <strong>Tool Bar</strong> 菜单中最常用的模块包括: </p>
<p>​    <strong>速度控制选项</strong> </p>
<p>​    它用于控制测试用例的执行速度。</p>
<p>​    <strong>步骤功能</strong> </p>
<p>​    它用于进入步骤，通过测试用例一次运行一个命令。用于调试测试 </p>
<p>​    用例。</p>
<p>​    <strong>运行测试</strong> </p>
<p>​    它用于运行当前选定的测试。 只加载一个测试，运行测试， 按钮 </p>
<p>​    和运行全部，按钮具有相同的效果。</p>
<p>​    <strong>全部运行</strong></p>
<p>​    它用于在加载具有多个测试用例的测试套件时运行整个测试套件。</p>
<p><strong>3. 地址栏</strong> </p>
<p>​    此模块提供了一个下拉菜单，可以记住基本 URL 的所有先前值。 简单来说，基 </p>
<p>​    本 URL 地址栏会记住以前访问过的网站，以便以后导航变得容易。</p>
<p><strong>4. 测试用例窗格</strong> </p>
<p>​    此模块包含 IDE 记录的所有测试用例。 简单来说，它在测试用例窗格下同时提 </p>
<p>​    供所有记录的测试用例的列表，以便用户可以轻松地在测试用例之间进行混洗。</p>
<p>​    在测试用例窗格的底部，可以看到测试执行结果摘要，其中包括各种测试 </p>
<p>​    用例的通过/失败状态。 </p>
<p>​    测试用例窗格还包括导航面板等功能，允许用户在测试用例和测试套件之间 </p>
<p>​    导航。 </p>
<p><strong>5.测试脚本编辑器框</strong></p>
<p>​    “测试脚本编辑器框”显示 IDE 记录的所有测试脚本和用户交互。 每个用户交互 </p>
<p>​    的显示顺序与执行顺序相同。 “编辑器”框分为三列:命令，目标和值。</p>
<p><strong>6. 开始/停止录制按钮</strong> </p>
<p>​    “记录”按钮记录浏览器的所有用户操作。</p>
<p><strong>7. 日志，引用窗格</strong> </p>
<p>​    日志窗格在执行期间显示运行时消息。 它提供 IDE 执行的操作的实时更新。 它 </p>
<p>​    可以分为四种类型：信息，错误，调试和警告。 </p>
<p>​    引用窗格在编辑器中显示当前所选 selenese 命令的完整详细信息</p>
<h2 id="4-Selenium-IDE-第一个测试用例"><a href="#4-Selenium-IDE-第一个测试用例" class="headerlink" title="4.Selenium IDE 第一个测试用例"></a><strong>4.Selenium IDE</strong> <strong>第一个测试用例</strong></h2><p>Selenium IDE 中的整个测试脚本创建过程可分为三个步骤: </p>
<ul>
<li><p>录制(记录用户与浏览器的交互) </p>
</li>
<li><p>播放(执行录制的脚本) </p>
</li>
<li><p>保存测试套件</p>
<h2 id="5-Selenium-IDE命令（Selenese）"><a href="#5-Selenium-IDE命令（Selenese）" class="headerlink" title="5.Selenium IDE命令（Selenese）"></a>5.Selenium IDE命令（Selenese）</h2></li>
</ul>
<p>Selenium 命令，也称为<strong>Selenese</strong> 是运行测试的 Selenium IDE 中使用 </p>
<p>的命令集。 使用 selenese，可以执行以下操作: </p>
<ul>
<li><p>根据 HTML 标记测试 UI 元素的存在。 </p>
</li>
<li><p>测试特定内容。 </p>
</li>
<li><p>测试断开的链接。 </p>
</li>
<li><p>测试输入字段，选择列表选项，提交表单和表格数据等。 </p>
</li>
<li><p>测试窗口大小，鼠标选项，警报，Ajax 功能，弹出窗口，事件 </p>
<p>处理和许多其他 Web 应用程序功能。 </p>
</li>
</ul>
<p>一系列 Selenium 命令(Selenese)一起称为测试脚本。</p>
<p>Selenium 命令基本上分为三类:</p>
<ul>
<li>操作 </li>
<li>访问器 </li>
<li>断言 </li>
</ul>
<p><strong>1.</strong> <strong>操作</strong> </p>
<p>操作(动作)是通常操纵应用程序状态的 selenium 命令。 执行操作会生成诸如单 </p>
<p>击此链接，选择该选项，键入此框等事件。如果操作失败或有错误，则停止执行 </p>
<p>当前测试。 </p>
<p>一些最常用的操作命令包括</p>
<table>
<thead>
<tr>
<th align="center">命令（语法）</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">open (url)</td>
<td align="center">它在指定的浏览器中启动所需的 URL，并接受相对和绝对 URL。</td>
</tr>
<tr>
<td align="center">type (locator,value)</td>
<td align="center">它设置输入字段的值，类似于用户输入操作。</td>
</tr>
<tr>
<td align="center">typeKeys (locator,value)</td>
<td align="center">此命令模拟指定元素上的击键事件。</td>
</tr>
<tr>
<td align="center">click (locator)</td>
<td align="center">此命令可以单击链接，按钮，复选框或单选按钮。</td>
</tr>
<tr>
<td align="center">clickAt (locator,coordString)</td>
<td align="center">此命令可在定位器和坐标的帮助下启用元素的单击</td>
</tr>
<tr>
<td align="center">doubleClick (locator)</td>
<td align="center">此命令允许基于指定的元素双击 web 元素。</td>
</tr>
<tr>
<td align="center">focus (locator)</td>
<td align="center">它将焦点移动到指定的元素</td>
</tr>
<tr>
<td align="center">highlight (locator)</td>
<td align="center">它将指定元素的背景颜色更改为黄色以突出显示，这对于调试目的很有用。</td>
</tr>
<tr>
<td align="center">close()</td>
<td align="center">此命令模拟用户单击弹出窗口或选项卡标题栏中的“关闭”按钮。</td>
</tr>
<tr>
<td align="center">store(expression,variableName)</td>
<td align="center">此命令指定要在其中存储结果的变量的名称，expression 是要存储的值。</td>
</tr>
<tr>
<td align="center">waitForCondition(script,timeout)</td>
<td align="center">此命令重复执行指定的 JavaScript 代码段，直到它的计算结果为 - true。</td>
</tr>
</tbody></table>
<p><strong>2.</strong> <strong>访问器</strong> </p>
<p>访问器是 selenium 命令，用于检查应用程序的状态并将结果存储在变量中。 它 </p>
<p>们还用于自动生成断言。 </p>
<p>一些最常用的访问器(Accessors)命令包括: </p>
<table>
<thead>
<tr>
<th align="center"><strong>命令(语法)</strong></th>
<th align="center"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">storeTitle (variableName)</td>
<td align="center">此命令获取当前页面的标题。</td>
</tr>
<tr>
<td align="center">storeText (locator, variableName)</td>
<td align="center">此命令获取元素的文本。</td>
</tr>
<tr>
<td align="center">storeValue (locator,variableName)</td>
<td align="center">此命令获取输入字段的(空白修剪)值。</td>
</tr>
<tr>
<td align="center">storeTable(tableCellAddress,variableName)</td>
<td align="center">此命令从表的单元格中获取文本。</td>
</tr>
<tr>
<td align="center">storeLocation (variableName)</td>
<td align="center">此命令获取当前页面的绝对 URL。</td>
</tr>
<tr>
<td align="center">storeElementIndex (locator, ariableName)</td>
<td align="center">此命令获取元素与其父元素的相对索引(从 0 开始)。</td>
</tr>
<tr>
<td align="center">storeBodyText (variableName)</td>
<td align="center">此命令获取页面的整个文本。</td>
</tr>
<tr>
<td align="center">storeAllButtons (variableName)</td>
<td align="center">它返回页面上所有按钮的 ID。</td>
</tr>
<tr>
<td align="center">storeAllFields (variableName)</td>
<td align="center">它返回页面上所有输入字段的 ID。</td>
</tr>
<tr>
<td align="center">storeAllLinks (variableName)</td>
<td align="center">它返回页面上所有链接的 ID。</td>
</tr>
</tbody></table>
<p><strong>3.</strong> <strong>断言</strong> </p>
<p>断言是使测试人员能够验证应用程序状态的命令。断言通常用于断言，验证和等待三种模式。 </p>
<p>一些最常用的断言命令是： </p>
<table>
<thead>
<tr>
<th align="center"><strong>命令/语法</strong></th>
<th align="center"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center">verifySelected(selectLocator,optionLocator)</td>
<td align="center">此命令验证下拉列表的选定选项是否满足 optionSpecifier。</td>
</tr>
<tr>
<td align="center">verifyAlert(pattern)</td>
<td align="center">此命令验证警报文本; 与accessorstoreAlert 一起使用。</td>
</tr>
<tr>
<td align="center">verifyAllButtons (pattern)</td>
<td align="center">此命令验证使用withaccessorstoreAllButtons 的按钮。</td>
</tr>
<tr>
<td align="center">verifyAllLinks(pattern)</td>
<td align="center">此命令验证所有链接; 与accessorstoreAllLinks 一起使用。</td>
</tr>
<tr>
<td align="center">verifyBodyText(pattern)</td>
<td align="center">此命令验证正文; 与accessorstoreBodyText 一起使用。</td>
</tr>
<tr>
<td align="center">verifyAttribute(attributeLocator, pattern)</td>
<td align="center">此命令验证元素的属性; 与accessorstoreAttribute 一起使用。</td>
</tr>
<tr>
<td align="center">waitForErrorOnNext (message)</td>
<td align="center">此命令启用等待错误; 与accessorassertErrorOnNext 一起使用</td>
</tr>
<tr>
<td align="center">waitForAlert (pattern)</td>
<td align="center">此命令启用等待警报; 与accessorstoreAlert 一起使用。</td>
</tr>
<tr>
<td align="center">verifyAllWindowIds (pattern)</td>
<td align="center">此命令验证窗口 ID; 与accessorstoreAllWindowIds 一起使用。</td>
</tr>
</tbody></table>
<h2 id="5-Selenium-IDE-手动创建测试用例"><a href="#5-Selenium-IDE-手动创建测试用例" class="headerlink" title="5.Selenium IDE 手动创建测试用例"></a><strong>5.Selenium IDE</strong> <strong>手动创建测试用例</strong></h2><p>要手动创建测试用例，首先必须完成在上面最常用的 selenium 命令。 现在，将在搜索引擎上操作创建第一个测试用例。在 Google 搜索引擎上搜索一些关键字。 </p>
<p><strong>1. 插入命令</strong> </p>
<ul>
<li>启动 Firefox 浏览器。 </li>
<li>单击浏览器右上角的 Selenium 图标。 </li>
<li>它将启动 Selenium IDE 的默认界面。 </li>
<li>输入项目名称为“手动测试”。 </li>
<li>输入测试用例名称为：搜索测试 。 </li>
<li>单击“测试脚本编辑器”框中的命令文本框。 </li>
<li>将第一个命令的属性修改为： </li>
<li>命令(Command)：open </li>
<li>目标(Target)：<a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com</a> </li>
<li>在执行测试用例期间，此命令将在 Firefox 浏览器上加载百度搜索引擎首页。</li>
</ul>
<p>现在，添加一个命令，单击百度搜索引擎文本框。 需要文本框的唯一标识元素，这将帮助 IDE 识别目标位置。 </p>
<p>用于查找唯一标识元素的方法涉及检查 HTML 代码。 </p>
<ul>
<li>在 Firefox 浏览器打开网址：<a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com</a> 。 </li>
<li>右键单击搜索文本框，然后选择 <em>Inspect Element</em> 。</li>
</ul>
<p><strong>IDE -</strong> <strong>手动创建测试用例</strong> </p>
<p>​                    它将启动一个窗口，其中包含测试盒开发中涉及的所有特定代码。 </p>
<p>选择包含文本框 ID 名称的 <em>input</em> 标记元素。 </p>
<ul>
<li>open </li>
</ul>
<p>将第二个命令的属性修改为： </p>
<ul>
<li><p>命令：click at </p>
</li>
<li><p>目标：id=kw </p>
</li>
<li><p>在执行测试用例期间，此命令将单击百度搜索引擎网页上的搜索文本框。 </p>
<p>注意：Value 对于大多数命令，“测试脚本编辑器”框的一部分是可选的。 </p>
</li>
</ul>
<p>第三个命令使用相同的标识 ID。 第三个命令将在百度搜索文本框中键入指定的文本。</p>
<ul>
<li>将第三个命令的属性修改为： </li>
<li>命令：type </li>
<li>目标：id=kw </li>
<li>值：犀利哥 </li>
</ul>
<p>在执行测试用例期间，此命令将在百度搜索文本框中键入指定的文本。 </p>
<p>接下来，添加一个命令，该命令将在网页上生成按钮的单击事件。 要生成此事件，需要搜索提交按钮的唯一标识元素。 </p>
<p>右键单击”百度一下”搜索按钮，然后选择 <em>Inspect Element</em> 。</p>
<p>它将启动一个窗口，其中包含搜索按钮所涉及的所有特定代码。 </p>
<p>选择包含百度搜索按钮的指定名称的 id 元素。 </p>
<p>将第四个命令的属性修改为： </p>
<p>命令：click at </p>
<p>目标：id=su </p>
<p>在执行测试用例期间，此命令将单击百度搜索引擎网页上的搜索按钮。 </p>
<p>接下来，准备执行第一个测试脚本。 </p>
<p><strong>2. 执行测试脚本</strong> </p>
<p>点击 IDE 的工具栏菜单上的按钮“运行当前测试”。 它将在浏览器上执行所有插入的命令，并提供已执行测试脚本的总体摘要。 </p>
<p>“日志”窗格显示已执行测试脚本的总体摘要。</p>
<h1 id="2-Webdriver-的概述、环境搭建"><a href="#2-Webdriver-的概述、环境搭建" class="headerlink" title="**2.**Webdriver 的概述、环境搭建"></a>**2.**Webdriver <strong>的概述、环境搭建</strong></h1><p>​    ebdriver (Selenium2）是一种用于 Web 应用程序的自动测试工具，它提供了一套友 好的 API，与 Selenium 1（Selenium-RC）相比，Webdriver 的 API 更容易理解和使用，其可读性和可维护性也大大提高。Webdriver 完全就是一套类库，不依赖于任何测试框架，除了必要的浏览器驱动，不需要启动其他进程或安装其他程序，也不必像 Selenium 1 那样需要先启动服务。 </p>
<h2 id="1-环境的搭建"><a href="#1-环境的搭建" class="headerlink" title="1.环境的搭建"></a>1.环境的搭建</h2><p>前提要求： </p>
<ol>
<li><p>安装好 python 解释器 </p>
</li>
<li><p>安装好 pycharm 软件</p>
</li>
</ol>
<p>实现步骤： </p>
<ol>
<li><p>下载好 geckodriver 驱动 </p>
</li>
<li><p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/mozilla/geckodriver/releases">https://github.com/mozilla/geckodriver/releases</a> </p>
</li>
<li><p>然后解压，把文件放到 python 解释器的安装目录 </p>
</li>
<li><p>Pycharm 里面导入 selenium 模块</p>
</li>
</ol>
<h2 id="2-第一个自动化测试的脚本"><a href="#2-第一个自动化测试的脚本" class="headerlink" title="2.第一个自动化测试的脚本"></a><strong>2.第一个自动化测试的脚本</strong></h2><p>​    注意，本文中的脚本案例，可能会随着目标网页的内容改版而失效，请仔细浏览思路。 </p>
<p><strong>(1)</strong> <strong>实现案例：</strong> </p>
<ul>
<li>启动火狐浏览器， </li>
<li>首先打开网易首页，打印网页标题，等待 3 秒 </li>
<li>打开百度首页，打印网页标题，再等待 2 秒 </li>
<li>关闭浏览器。 </li>
</ul>
<p><strong>(2)</strong> <strong>实现代码</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line"><span class="comment">#加载浏览器驱动 </span></span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line"><span class="comment">#打开网易首页 </span></span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.163.com&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#打印标题 </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(driver.title) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#打开百度首页 </span></span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(driver.title) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭浏览器 </span></span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h2 id="3-浏览器操作的方法"><a href="#3-浏览器操作的方法" class="headerlink" title="3.浏览器操作的方法"></a><strong>3.浏览器操作的方法</strong></h2><p><strong>1.</strong> <strong>浏览器的操作方法：</strong> </p>
<p>​    1 浏览器窗口大小设置：set_window_size(宽,高) </p>
<p>​    2 页面前进、后退：back()、forward() </p>
<p>​    3 页面刷新：refresh() </p>
<p><strong>2.</strong> <strong>案例：访问京东页面和京东男装页面</strong> </p>
<ol>
<li><p>打开京东，等 2 秒 </p>
</li>
<li><p>打开京东男装，设置窗口为(400,800) </p>
</li>
<li><p>刷新一下页面，等 2 秒 </p>
</li>
<li><p>后退，等 2 秒 </p>
</li>
<li><p>前进，等 2 秒 </p>
</li>
<li><p>关闭窗口 </p>
</li>
</ol>
<p><strong>3. 实现代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line"><span class="comment">#打开京东 </span></span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;https://www.jd.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">driver.maximize_window() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#打开京东男装 </span></span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;https://channel.jd.com/1315-1342.html&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#设置页面的窗体大小 </span></span><br><span class="line"></span><br><span class="line">driver.set_window_size(<span class="number">400</span>,<span class="number">800</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#刷新一下页面 </span></span><br><span class="line"></span><br><span class="line">driver.refresh() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#后退 </span></span><br><span class="line"></span><br><span class="line">driver.back() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#前进 </span></span><br><span class="line"></span><br><span class="line">driver.forward() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="3-元素的定位"><a href="#3-元素的定位" class="headerlink" title="3.元素的定位"></a>3.元素的定位</h1><h3 id="1-通过-id-选择器、name-值去定位元素"><a href="#1-通过-id-选择器、name-值去定位元素" class="headerlink" title="(1) 通过 id 选择器、name 值去定位元素"></a><strong>(1)</strong> <strong>通过</strong> <strong>id</strong> <strong>选择器、</strong>name <strong>值去定位元素</strong></h3><ol>
<li><p>打开网页 </p>
</li>
<li><p>右击检查元素或者 F12 可以看到 id 与 name </p>
</li>
</ol>
<p><strong>案例：打开百度，输入”码云”，点击搜素按钮</strong> </p>
<p>1 打开百度网址 </p>
<p>2 定位到输入框，输入“码云” </p>
<p>3 定位到搜素按钮，点击一下 </p>
<p>4 打开搜素页面 </p>
<p><strong>实现代码：</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#百度输入框的 id 名 kw </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;码云&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#百度输入框的 name 属性值 kw </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#driver.find_element_by_name(&quot;wd&quot;).send_keys(&quot;码云&quot;) </span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#百度的搜素按钮的 id 名为 su </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).click() </span><br></pre></td></tr></table></figure>

<p>可以看出：.send_keys(“值”)表示在输入框输入的值</p>
<h3 id="2-通过通过标签名-tag-name-来定位"><a href="#2-通过通过标签名-tag-name-来定位" class="headerlink" title="(2) 通过通过标签名(tag_name)来定位"></a><strong>(2)</strong> <strong>通过通过标签名</strong>(tag_name)来定位</h3><p>页面 html 文档下的各种标签： </p>
<p>​        find_element_by_tag_name(“input”)； </p>
<p>​    tag 往往用来定义一类功能，所以通过 tag 识别某个元素的概率 </p>
<p>很低。任意打开一个页面，都会发现大量的&lt;div&gt;、&lt;input&gt;、&lt;a&gt;等 </p>
<p>tag，所以 tag name 定位很少用</p>
<h3 id="3-通过-class-name-来定位"><a href="#3-通过-class-name-来定位" class="headerlink" title="(3) 通过 class_name 来定位"></a><strong>(3)</strong> <strong>通过</strong> <strong>class_name</strong> <strong>来定位</strong></h3><p>​    根据标签中属性 class 来进行定位的一种方法</p>
<p><strong>案例：</strong></p>
<p>1 打开百度</p>
<p>2 通过类名定位输入框，搜素“龟叔” </p>
<p>3 然后点击搜素，弹出搜素页面 </p>
<p><strong>实现代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">\<span class="comment">#百度输入框在类名 s_ipt 中 </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_class_name(<span class="string">&quot;s_ipt&quot;</span>).send_keys(<span class="string">&quot;龟叔&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;su&quot;</span>).click() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">5</span>) </span><br><span class="line"></span><br><span class="line">driver.quit() </span><br></pre></td></tr></table></figure>

<h3 id="4-通过-link-Text-定位：专门用来定位文本链接"><a href="#4-通过-link-Text-定位：专门用来定位文本链接" class="headerlink" title="(4) 通过 link_Text 定位：专门用来定位文本链接."></a><strong>(4)</strong> <strong>通过</strong> <strong>link_Text</strong> <strong>定位：专门用来定位文本链接</strong>.</h3><p>对象名.find_element_by_link_name(“text”)； </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#页面右上方的一些个人操作，比如退出、个人中心、消息通知等 </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_link_text(<span class="string">u&quot;退出&quot;</span>).click()</span><br></pre></td></tr></table></figure>

<h3 id="5-XPath-定位：（了解）"><a href="#5-XPath-定位：（了解）" class="headerlink" title="(5) XPath 定位：（了解）"></a><strong>(5) XPath</strong> <strong>定位：（了解）</strong></h3><p>对象名.find_element_by_xpath(“xpath 路径”)；</p>
<p><strong>1</strong>）绝对路径定位：</p>
<p>​    对于没有 id，name、classname 不好定位的，可以通过Firefox 可以方便的获取到 xpath 值 </p>
<p><strong>2</strong>） 利用元素属性定位：</p>
<p>​    find_element_by_xpath(“.//*[@id=’Title’]”)，这里是用的id，也可以用元素其他能够唯一标识的属性，不局限于 id、name、class 这些；*代表的是标签名，不指定时就可以用*代替</p>
<p>案例代码： </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 登录 </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&quot;.//*[@id=&#x27;divword&#x27;]/input[7]&quot;</span>).click() </span><br><span class="line"></span><br><span class="line"><span class="comment">#个人页面的发布课程操作 </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&quot;html/body/div[4]/div/div[2]/div/div[3]/a[1]&quot;</span>).click() </span><br></pre></td></tr></table></figure>

<h3 id="6-CSS-常用定位方法"><a href="#6-CSS-常用定位方法" class="headerlink" title="(6) CSS 常用定位方法"></a><strong>(6) CSS</strong> <strong>常用定位方法</strong></h3><ol>
<li><p>find_element_by_css_selector（） </p>
</li>
<li><p>#id id 选择器根据 id 属性来定位元素 </p>
</li>
<li><p>.class class 选择器，根据 class 属性值来定位元素 </p>
</li>
<li><p>[attribute=’value’] 根据属性来定位元素 </p>
</li>
<li><p>element&gt;element 根据元素层级来定位 父元素&gt;子元素 </p>
</li>
</ol>
<p>案例代码： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from selenium import webdriver </span><br><span class="line"></span><br><span class="line">from time import sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(&quot;http://www.baidu.com&quot;) </span><br><span class="line"></span><br><span class="line">#根据 id 来定位 </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(&#x27;#kw&#x27;).send_keys(&quot;今日头条&quot;) </span><br><span class="line"></span><br><span class="line">#根据 class 定位 </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(&#x27;.s_ipt&#x27;).send_keys(&#x27;python&#x27;) </span><br><span class="line"></span><br><span class="line">#通过属性来定位 </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(&quot;[autocomplete=&#x27;off&#x27;]&quot;).send_keys(&quot;selenium&quot;) </span><br><span class="line"></span><br><span class="line">sleep(2) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_id(&#x27;su&#x27;).click() </span><br><span class="line"></span><br><span class="line">driver.get(&quot;http://www.toutiao.com&quot;) </span><br><span class="line"></span><br><span class="line">#通过元素层级来定位 </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(&quot;form#loginForm&gt;ul&gt;input&quot;).send_keys(&quot;今日头条&quot;)</span><br><span class="line"></span><br><span class="line">sleep(2) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h3 id="7-下拉菜单定位"><a href="#7-下拉菜单定位" class="headerlink" title="(7) 下拉菜单定位"></a><strong>(7)</strong> <strong>下拉菜单定位</strong></h3><p>下拉菜单元素定位 </p>
<p>案例：在今日头条登录页面选择指定的保留时间。 </p>
<p>​    下面的案例可能会随着网页的内容改版，会失效，请参考思路。 </p>
<p>**1.**根据选项元素标签定位 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.toutiao.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#根据 option 标签来定位 </span></span><br><span class="line"></span><br><span class="line">driver.find_elements_by_tag_name(<span class="string">&#x27;option&#x27;</span>)[<span class="number">1</span>].click() </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;[value=&#x27;2&#x27;]&quot;</span>).click() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.quit() </span><br></pre></td></tr></table></figure>

<p>**2.**<strong>使用</strong> <strong>Select</strong> <strong>类定位</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.toutiao.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#利用 Select 类来进行定位 </span></span><br><span class="line"></span><br><span class="line">select = Select(driver.find_element_by_css_selector(<span class="string">&quot;[name=&#x27;CookieDate&#x27;]&quot;</span>))</span><br><span class="line"></span><br><span class="line">select.select_by_index(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">select.select_by_visible_text(<span class="string">&quot;留一年&quot;</span>) </span><br><span class="line"></span><br><span class="line">select.select_by_value(<span class="string">&quot;1&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="4-鼠标键盘的操作"><a href="#4-鼠标键盘的操作" class="headerlink" title="4.鼠标键盘的操作"></a><strong>4.鼠标键盘的操作</strong></h1><p><strong>1.</strong> <strong>实现思路</strong> </p>
<ul>
<li>需要引入 ActionChains 类 </li>
<li>然后定位相关元素 </li>
<li>在 ActionChains().调用相关鼠标操作方法 </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">driver.maximize_window() </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(<span class="string">&quot;Python&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取搜索框元素对象</span></span><br><span class="line"></span><br><span class="line">element=driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#双击操作</span></span><br><span class="line"></span><br><span class="line">ActionChains(driver).double_click(element).perform() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#右击操作</span></span><br><span class="line"></span><br><span class="line">ActionChains(driver).context_click(element).perform() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#鼠标悬停</span></span><br><span class="line"></span><br><span class="line">above=driver.find_element_by_css_selector(<span class="string">&quot;.pf&quot;</span>) </span><br><span class="line"></span><br><span class="line">ActionChains(driver).move_to_element(above).perform() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">4</span>) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p><strong>2.</strong> <strong>键盘操作</strong> </p>
<p>案例： 在百度搜索关键词“Python” 然后将关键词复制或剪切到搜狗搜索框进行搜索 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys </span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(<span class="string">&quot;Python&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#键盘全选操作 Ctrl+A</span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;a&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#键盘选择复制或剪切操作 Ctrl+C</span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;c&#x27;</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;x&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#打开搜狗页面</span></span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.sogou.com/&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#粘贴复制内容</span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;.sec-input&quot;</span>).send_keys(Keys.CONTROL,<span class="string">&#x27;v&#x27;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#点击搜索按钮 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># driver.find_element_by_xpath(&quot;//input[@id=&#x27;stb&#x27;]&quot;).click()* </span></span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#stb&quot;</span>).click() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p><strong>3.</strong> <strong>元素的等待</strong> </p>
<p>显示等待是针对某一个元素进行相关等待判定； </p>
<p>隐式等待不针对某一个元素进行等待，全局元素等待。 </p>
<p><strong>a.相关模块</strong></p>
<ul>
<li>WebDriverWait 显示等待针对元素必用 </li>
<li>expected_conditions 预期条件类（里面包含方法可以调用，用于显示等待） </li>
<li>NoSuchElementException用于隐式等待抛出异常 </li>
<li>By 用于元素定位 </li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> By </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait <span class="comment">#注意字母大写 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</span><br></pre></td></tr></table></figure>

<p><strong>b.显示等待</strong></p>
<p>案例：检测百度页面搜索按钮是否存在，存在就输入关键词“Selenium” 然后点击搜索 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(<span class="string">&quot;Selenium&quot;</span>)</span><br><span class="line">sleep(<span class="number">2</span>) <span class="comment">#显示等待--判断搜索按钮是否存在</span></span><br><span class="line">element=WebDriverWait(driver,<span class="number">5</span>,<span class="number">0.5</span>).until(EC.presence_of_element_located((By.ID,<span class="string">&quot;su&quot;</span>))) element.click() </span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p><strong>C.隐式等待</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException </span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep,ctime </span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">5</span>) <span class="comment">#隐式等待时间设定 5 秒 </span></span><br><span class="line"><span class="comment">#检测搜索框是否存在 </span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">	<span class="built_in">print</span>(ctime()) </span><br><span class="line">	driver.find_element_by_css_selector(<span class="string">&quot;#kw&quot;</span>).send_keys(<span class="string">&quot;Python&quot;</span>) </span><br><span class="line">	driver. find_element_by_css_selector(<span class="string">&quot;#su&quot;</span>).click </span><br><span class="line"><span class="keyword">except</span> NoSuchElementException <span class="keyword">as</span> msg:</span><br><span class="line">	<span class="built_in">print</span>(msg)</span><br><span class="line"><span class="keyword">finally</span>: </span><br><span class="line">	<span class="built_in">print</span>(ctime()) </span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="5-警告弹窗的处理"><a href="#5-警告弹窗的处理" class="headerlink" title="5.警告弹窗的处理"></a><strong>5.警告弹窗的处理</strong></h1><p>案例：点击百度首页设置按钮，然后进入搜索设置页面， </p>
<p>点击“保存设置”或“恢复默认”按钮，处理警告弹窗窗口 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&#x27;设置&#x27;</span>).click() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&#x27;搜索设置&#x27;</span>).click() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&#x27;保存设置&#x27;</span>).click() </span><br><span class="line"></span><br><span class="line"><span class="comment"># driver.find_element_by_link_text(&#x27;恢复默认&#x27;).click()</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#处理警告窗口 </span></span><br><span class="line"></span><br><span class="line">alert=driver.switch_to_alert() </span><br><span class="line"></span><br><span class="line">alert.accept() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.quit() </span><br></pre></td></tr></table></figure>

<h1 id="6-文件上传"><a href="#6-文件上传" class="headerlink" title="6.文件上传"></a><strong>6.文件上传</strong></h1><p>案例：在百度搜索上传本地图片进行搜索。 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;.soutu-btn&quot;</span>).click() </span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line">driver.find_element_by_css_selector(<span class="string">&quot;.upload-pic&quot;</span>).send_keys(<span class="string">r&quot;E:\Python_script\Web driver\shuiyin.png&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"><span class="comment"># driver.quit()</span></span><br></pre></td></tr></table></figure>

<h1 id="7-浏览器滚动操作"><a href="#7-浏览器滚动操作" class="headerlink" title="7.浏览器滚动操作"></a><strong>7.浏览器滚动操作</strong></h1><p>案例：打开京东页面，然后将滚动条拖到最底部，然后再拖到顶部 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;https://www.jd.com/&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#将滚动调拖到最底部 </span></span><br><span class="line"></span><br><span class="line">js=<span class="string">&quot;var action=document.documentElement.scrollTop=10000&quot;</span> </span><br><span class="line"></span><br><span class="line">driver.execute_script(js) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#将滚动条拖到最顶部 </span></span><br><span class="line"></span><br><span class="line">js=<span class="string">&quot;var action=document.documentElement.scrollTop=0&quot;</span> </span><br><span class="line"></span><br><span class="line">driver.execute_script(js) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line">driver.quit() </span><br></pre></td></tr></table></figure>

<h1 id="8-网页自动截图"><a href="#8-网页自动截图" class="headerlink" title="8.网页自动截图"></a><strong>8.网页自动截图</strong></h1><p>案例：打开百度页面，然后进行截图 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line"><span class="comment">#加载浏览器驱动 </span></span><br><span class="line">driver=webdriver.Firefox()</span><br><span class="line"><span class="comment">#打开百度页面并截图 </span></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>) driver.get_screenshot_as_file(<span class="string">r&quot;E:\Python_script\baidu.png&quot;</span>) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="9-Cookie-处理"><a href="#9-Cookie-处理" class="headerlink" title="**9.**Cookie 处理"></a>**9.**Cookie <strong>处理</strong></h1><p><strong>1.</strong> <strong>什么是</strong> <strong>cookie</strong> </p>
<p>​    Cookie 是储存在用户本地终端上的数据，实际上是一小段的文本信息。 </p>
<p><strong>2.</strong> <strong>Cookie</strong> <strong>的作用</strong> </p>
<p>​    帮助 Web 站点保存有关访问者的信息，方便用户的访问。 </p>
<p>​    如记住用户名密码实现自动登录。 </p>
<p>​    案例：查看访问京东时的 Cookie 内容 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.jd.com/&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#获取 cookie 全部内容 </span></span><br><span class="line"></span><br><span class="line">cookie=driver.get_cookies() </span><br><span class="line"></span><br><span class="line"><span class="comment">#打印全部 cookile 信息 </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cookie) </span><br><span class="line"></span><br><span class="line"><span class="comment">#打印 cookie 第一组信息 </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cookie[<span class="number">0</span>]) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<p><strong>3.</strong> <strong>验证码作用</strong> </p>
<p>​    不少网站在用户登录、用户提交信息等登录和输入的页面上使用了验证码技术。验证码技术可以有效防止恶意用户对网站的滥用，使得网站可以有效避免用户信息失窃、保证网站稳定安全性。 </p>
<p>但是验证码给自动化测试带来一些不便，使脚本无法正常运行覆盖功能模块。</p>
<h1 id="10-验证码的处理"><a href="#10-验证码的处理" class="headerlink" title="10.验证码的处理"></a><strong>10.验证码的处理</strong></h1><p><strong>1.去掉验证码</strong></p>
<p>​    这是最简单的方法，对于开发人员来说，只是把验证码的相关代码注释掉即可，如果是在测试环境，这样做可省去了测试人员不少麻烦，如果自动化脚本是要在正式环境跑，这样就给系统带来了一定的风险。 </p>
<p><strong>2.设置万能码</strong> </p>
<p>​    去掉验证码的主要是安全问题，为了应对在线系统的安全性威胁，可以在修改程序时不取消验证码，而是程序中留一个“后门”—设置一个“万能验证码”，只要用户输入这个“万能验证码”，程序就认为验证通过，否则按照原先的验证方式进行验证。 </p>
<p><strong>3.记录 cookie</strong> </p>
<p>​    通过向浏览器中添加 cookie 可以绕过登录的验证码。</p>
<h1 id="11-基于-Cookie-绕过验证码"><a href="#11-基于-Cookie-绕过验证码" class="headerlink" title="11.基于 Cookie 绕过验证码"></a><strong>11.基于</strong> <strong>Cookie</strong> <strong>绕过验证码</strong></h1><p>案例：使用 Cookie 绕过百度验证码自动登录账户。 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox() </span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://www.baidu.com/&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">#手动添加 cookie </span></span><br><span class="line"></span><br><span class="line">driver.add_cookie(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;BAIDUID&#x27;</span>,<span class="string">&#x27;value&#x27;</span>:<span class="string">&#x27;9E4BF1D44014…(根据实际获取值填写)&#x27;</span>&#125;) </span><br><span class="line"></span><br><span class="line">driver.add_cookie(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;BDUSS&#x27;</span>,<span class="string">&#x27;value&#x27;</span>:<span class="string">&#x27;根据实际抓包获取值填写&#x27;</span>&#125;) </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">driver.refresh() </span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>) </span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h1 id="12-自动化测试模型"><a href="#12-自动化测试模型" class="headerlink" title="12.自动化测试模型"></a>12.自动化测试模型</h1><p><strong>概念</strong></p>
<p>自动化测试模型可以看作自动化测试框架与工具设计的思想。自动化测试不仅仅是单纯写写脚本运行就可以了，还需要考虑到如何使脚本运行效率提高，代码复用、参数化等问题。自动化测试模型分为四大类：线性模型，模块化驱动测试、数据驱动、关键词驱动。</p>
<p>· 工具：帝国CMS</p>
<p>· 下载地址：<a target="_blank" rel="noopener" href="http://www.phome.net/download/">http://www.phome.net/download/</a></p>
<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a><em><strong>安装步骤</strong></em></h3><p>不需要你安装任何软件！！！</p>
<p>· 1、解压安装包；</p>
<p>· 2、将安装包的“EmpireServer”目录复制到D盘根目录；(D:\EmpireServer目录名不可更改)</p>
<p>· 3、双击“D:\EmpireServer\一键安装.bat”；(要鼠标右键以管理员身份运行)</p>
<p>· 4、至此，运行环境及帝国CMS全部安装完毕；</p>
<p>· 5、在浏览器打入：<a target="_blank" rel="noopener" href="http://localhost/e/admin">http://localhost/e/admin</a> 后回车，进入帝国CMS后台登陆界面。</p>
<p>· 前台地址：<a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a></p>
<p>· 后台地址：<a target="_blank" rel="noopener" href="http://localhost/e/admin">http://localhost/e/admin</a> (登录用户名、密码与认证码均为admin)</p>
<p>· 搭建完成之后注册一个测试账号 Test 密码：123456</p>
<h3 id="线性模型"><a href="#线性模型" class="headerlink" title="线性模型"></a><em><strong>线性模型</strong></em></h3><p>线性脚本中每个脚本都相互独立，且不会产生其他依赖与调用，其实就是简单模拟用户某个操作流程的脚本。</p>
<p>案例：在帝国软件主页自动登录和退出操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;http://localhost&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输入用户名</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;username&#x27;</span>).clear()</span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;username&#x27;</span>).send_keys(<span class="string">&#x27;Test&#x27;</span>)</span><br><span class="line"><span class="comment">#输入密码</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).clear()</span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).send_keys(<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#点击登陆</span></span><br><span class="line">driver.find_element_by_name(<span class="string">&#x27;Submit&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#退出</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">&#x27;退出&#x27;</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.switch_to_alert().accept()</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></table></figure>

<h3 id="模块化驱动测试"><a href="#模块化驱动测试" class="headerlink" title="模块化驱动测试"></a><em><strong>模块化驱动测试</strong></em></h3><p>线性模型虽然每个用例都可以拿出来独立运行，但是用例之间重复代码很多，开发、维护成本高。其实把重复的操作代码封装为独立的公共模块【函数】，当用例执行时需要用到这部分，直接调用即可，这就是模块驱动的方式。比如登录系统、退出登录、截图函数等等。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">user_login</span>(<span class="params">self,driver</span>):</span></span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;username&#x27;</span>).clear()</span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;username&#x27;</span>).send_keys(<span class="string">&#x27;Test&#x27;</span>)<span class="comment">#固定</span></span><br><span class="line"></span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).clear()</span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).send_keys(<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;Submit&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">user_logout</span>(<span class="params">self,driver</span>):</span></span><br><span class="line">        driver.find_element_by_link_text(<span class="string">&#x27;退出&#x27;</span>).click()</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        driver.switch_to_alert().accept()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    driver = webdriver.Firefox()</span><br><span class="line">    driver.get(<span class="string">&quot;http://localhost/&quot;</span>)</span><br><span class="line">    driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    Login().user_login(driver)</span><br><span class="line">    Login().user_logout(driver)</span><br></pre></td></tr></table></figure>

<p>调用登录模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> LoginClass <span class="keyword">import</span> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">&quot;http://localhost/&quot;</span>)</span><br><span class="line"></span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Login().user_login(driver)</span><br><span class="line"></span><br><span class="line">Login().user_logout(driver)</span><br></pre></td></tr></table></figure>

<h3 id="数据驱动测试"><a href="#数据驱动测试" class="headerlink" title="数据驱动测试"></a><em><strong>数据驱动测试</strong></em></h3><p>模块驱动的模型虽然解决了脚本的重复问题，但是需要测试不同数据的用例时，模块驱动的方式就不很适合了。 数据驱动就是数据的改变从而驱动自动化测试的执行，最终引起测试结果的改变。 装载数据的方式可以是列表、字典或是外部文件（txt、csv、xml、excel），目的就是实现数据和脚本的分离。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">user_login</span>(<span class="params">self,driver,username,password</span>):</span></span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;username&#x27;</span>).clear()</span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;username&#x27;</span>).send_keys(username)<span class="comment">#username 可变的</span></span><br><span class="line"></span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).clear()</span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;password&#x27;</span>).send_keys(password)</span><br><span class="line"></span><br><span class="line">        driver.find_element_by_name(<span class="string">&#x27;Submit&#x27;</span>).click()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">user_logout</span>(<span class="params">self,driver</span>):</span></span><br><span class="line">        driver.find_element_by_link_text(<span class="string">&#x27;退出&#x27;</span>).click()</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        driver.switch_to_alert().accept()</span><br></pre></td></tr></table></figure>

<p>数据驱动调用——实现多个账户登录</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> LoginClass_Para <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span>  selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver=webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">&quot;http://localhost&quot;</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">Login().user_login(driver,<span class="string">&quot;Test&quot;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">Login().user_logout(driver)</span><br><span class="line"></span><br><span class="line">Login().user_login(driver,<span class="string">&quot;TestPro&quot;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line">Login().user_logout(driver)</span><br></pre></td></tr></table></figure>

<h3 id="关键字驱动测试"><a href="#关键字驱动测试" class="headerlink" title="关键字驱动测试"></a><em><strong>关键字驱动测试</strong></em></h3><p>Comand  修改其命令</p>
<p>通过关键字的改变引起测试结果的改变叫关键字驱动测试。 selenium IDE也是一种传统的关键字驱动的自动化工具，Robot Framework 是一个功能更强大的关键字驱动测试框架</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/07/web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" data-id="ckt9vc0ia0000o0ty2agx8mnc" data-title="web自动化测试" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/09/07/python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          python单元测试
        
      </div>
    </a>
  
  
    <a href="/2021/09/03/linux%E5%AD%A6%E4%B9%A0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">linux学习</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/09/14/django%E8%BF%9E%E6%8E%A5mysql/">django连接mysql</a>
          </li>
        
          <li>
            <a href="/2021/09/13/pip%E5%AE%89%E8%A3%85%E5%BA%93%E6%97%B6%E4%BD%BF%E7%94%A8%E8%B1%86%E7%93%A3%E9%95%9C%E5%83%8F/">pip安装库时使用豆瓣镜像</a>
          </li>
        
          <li>
            <a href="/2021/09/10/python%E5%8F%91%E9%80%81%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A%E7%9A%84%E6%A8%A1%E6%9D%BF/">python发送测试报告的模板</a>
          </li>
        
          <li>
            <a href="/2021/09/08/appium%E5%AD%A6%E4%B9%A0/">appium学习</a>
          </li>
        
          <li>
            <a href="/2021/09/07/python%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">python单元测试</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>